<!DOCTYPE html>
<html>

<head>
    <meta charset='utf-8'>
    <meta http-equiv='X-UA-Compatible' content='IE=edge'>
    <title>pdf-iframe</title>
    <meta name='viewport' content='width=device-width, initial-scale=1'>
    <style>
        #img-wrapper {
            overflow: scroll;
            width: 50vw;
            height: 50vh;
        }
        #img {
            touch-action: pinch-zoom;
        }
    </style>
</head>

<body>

    <h1>Zoomテスト</h1>
    <div id="img-wrapper">
        <img id="img" src="./sample.png" >
    </div>


    <script>
        let scale = 1;
        let startDist = 0;

        function getDist(t1, t2) {
            const dx = t2.clientX - t1.clientX;
            const dy = t2.clientY - t1.clientY;
            return Math.hypot(dx, dy);
        }

        document.querySelector('#img').addEventListener('touchstart', function(e) {
            const touches = e.touches;
            if (touches.length === 2) {
                startDist = getDist(touches[0], touches[1]);
            }
        });
        document.querySelector('#img').addEventListener('touchmove', function(e) {
            const touches = e.touches;

            if (touches.length === 2) {
                e.preventDefault(); // ブラウザの標準ピンチを止める

                const newDist = getDist(touches[0], touches[1]);
                const ratio = newDist / startDist;
                startDist = newDist;

                scale *= ratio;
                scale = Math.min(Math.max(scale, 0.5), 4); // 限界

                document.querySelector('#img').style.transform = `scale(${scale})`;
            }
        });

    </script>



</body>

</html>
